 <!DOCTYPE html>
 <html lang="ja">
 <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>é€±é–“æ´»å‹•å†…è¨³</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      max-width: 1000px; /* é€±é–“è¡¨ç¤ºãªã®ã§å°‘ã—åºƒã‚ã« */
      margin: auto;
      background: #f5f6fa;
      color: #333;
      padding: 15px;
      box-sizing: border-box;
    }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #4a90e2;
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    header h1 {
      font-size: 1.4em;
      margin: 0;
    }
    .top-icons a {
      margin-left: 10px;
      color: white;
      font-size: 1.4em;
      text-decoration: none;
      padding: 5px;
    }
    .week-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    .week-navigation button {
      background: #6c757d;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9em;
      transition: background 0.2s;
    }
    .week-navigation button:hover {
      background: #5a6268;
    }
    #weekDisplay {
      font-weight: bold;
    }

    /* é€±è¡¨ç¤ºãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    #weeklyTableContainer {
      overflow-x: auto; /* æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å¯èƒ½ã«ã™ã‚‹ */
      background: white;
      border: 1px solid #ddd;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      padding: 10px; /* ãƒ†ãƒ¼ãƒ–ãƒ«å†…å¤–ã«ä½™ç™½ */
    }
    #weeklyTable {
      width: 100%; /* ã‚³ãƒ³ãƒ†ãƒŠã„ã£ã±ã„ã«åºƒãŒã‚‹ */
      border-collapse: collapse; /* ã‚»ãƒ«ã®å¢ƒç•Œç·šã‚’çµåˆ */
      min-width: 1200px; /* 3åˆ—ã«ãªã£ãŸã®ã§ã•ã‚‰ã«åºƒã’ã‚‹ */
    }
    #weeklyTable th, #weeklyTable td {
      border: 1px solid #ccc; /* â˜…ä¿®æ­£ï¼šé€šå¸¸è¡¨ç¤ºã®ç½«ç·š */
      padding: 4px 8px; /* ä¸Šä¸‹ãƒ‘ãƒ‡ã‚£ãƒ³ã‚° */
      text-align: left;
      vertical-align: top; /* ä¸Šæƒãˆ */
      font-size: 0.85em; /* æ–‡å­—ã‚’å°ã•ã‚ã« */
      box-sizing: border-box; /* paddingã‚’å¹…ã«å«ã‚ã‚‹ */
    }
    #weeklyTable th {
      background: #f8f9fa;
      font-weight: bold;
      white-space: nowrap; /* ãƒ†ã‚­ã‚¹ãƒˆãŒæ”¹è¡Œã•ã‚Œãªã„ã‚ˆã†ã« */
      text-align: center; /* ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã¯ä¸­å¤®æƒãˆ */
    }
    #weeklyTable td {
      background: white;
      line-height: 1.2; /* è¡Œé–“ã‚’èª¿æ•´ */
      white-space: normal; /* é€šå¸¸ã®æ”¹è¡Œã‚’è¨±å¯ */
      word-break: break-word; /* é•·ã„å˜èªã§ã‚‚å¼·åˆ¶æ”¹è¡Œ */
    }
    #weeklyTable td.time-cell {
      text-align: center; /* æ™‚é–“è¡¨ç¤ºã¯ä¸­å¤®æƒãˆ */
      font-weight: bold;
    }
    #weeklyTable .activity-content {
        /* ã‚„ã£ãŸã“ã¨ã®ã‚»ãƒ«å†…ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ« */
        margin: 0;
        padding: 0;
    }
    #weeklyTable .mood-value, #weeklyTable .fatigue-value {
        text-align: center; /* æ°—åˆ†ãƒ»ç–²åŠ´åº¦ã¯æ•°å€¤ãªã®ã§ä¸­å¤®æƒãˆ */
        white-space: nowrap; /* æ•°å€¤ã¯æ”¹è¡Œã—ãªã„ */
    }
    #weeklyTable .memo-content {
        font-size: 0.8em;
        color: #555;
        margin-top: 5px; /* ã‚„ã£ãŸã“ã¨ã¨ã®é–“éš” */
        border-top: 1px dashed #eee; /* ä¸Šéƒ¨ã«ç‚¹ç·š */
        padding-top: 5px; /* ç‚¹ç·šã¨ã®é–“éš” */
    }

    .daily-summary {
      font-size: 0.8em;
      color: #666;
      border-top: 1px dashed #eee;
    }
    .daily-summary p {
        margin: 0;
        padding: 0;
    }

    /* å°åˆ·ç”¨ã‚¹ã‚¿ã‚¤ãƒ« (æ¨ªé•·A4ã‚µã‚¤ã‚ºèª¿æ•´) ã¨ç”»åƒä¿å­˜ç”¨ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å…±é€šåŒ– */
    /* .printable-area ã‚¯ãƒ©ã‚¹ãŒbodyã«ä»˜ä¸ã•ã‚ŒãŸã¨ãã«é©ç”¨ã•ã‚Œã‚‹ã‚¹ã‚¿ã‚¤ãƒ« */
    .printable-area {
      margin: 0 !important;
      padding: 1% 2% 1% 3% !important; /* A4æ¨ªé•·ã‚’æƒ³å®šã—ãŸä½™ç™½ */
      max-width: none !important;
      width: 297mm !important; /* A4æ¨ªå¹… */
      height: 210mm !important; /* A4ç¸¦å¹… */
      overflow: hidden !important;
      display: block !important;
      box-sizing: border-box !important;
      background-color: white !important;
    }
    .printable-area header,
    .printable-area .week-navigation,
    .printable-area .top-icons {
      display: none !important;
    }
    .printable-area #weeklyTableContainer {
      border: none !important;
      box-shadow: none !important;
      padding: 0 !important;
      width: 100% !important;
      height: 100% !important;
      display: block !important;
      overflow: visible !important;
      box-sizing: border-box !important;
    }
    .printable-area #weeklyTable {
      width: 100% !important;
      height: 100% !important;
      border-collapse: collapse !important;
      table-layout: fixed !important;
      font-size: 0.3em !important;
    }

    /* åˆ—å¹…ã®èª¿æ•´ */
    .printable-area #weeklyTable thead tr th:first-child,
    .printable-area #weeklyTable tbody tr td.time-cell {
      width: 4% !important;
      min-width: 0 !important;
    }
    .printable-area #weeklyTable thead tr th:nth-child(3n+2) { /* ã‚„ã£ãŸã“ã¨ */
        width: calc((96% / 7) * 0.7) !important;
    }
    .printable-area #weeklyTable thead tr th:nth-child(3n+3), /* æ°—åˆ† */
    .printable-area #weeklyTable thead tr th:nth-child(3n+4) { /* ç–²åŠ´åº¦ */
        width: calc((96% / 7) * 0.15) !important;
    }

    /* å„æ—¥ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ«å¹…ã‚’èª¿æ•´ */
    .printable-area #weeklyTable tbody tr td.activity-col { /* ã‚„ã£ãŸã“ã¨ */
        width: calc((96% / 7) * 0.7) !important;
    }
    .printable-area #weeklyTable tbody tr td.mood-col, /* æ°—åˆ† */
    .printable-area #weeklyTable tbody tr td.fatigue-col { /* ç–²åŠ´åº¦ */
        width: calc((96% / 7) * 0.15) !important;
        text-align: center !important;
    }

    /* è¡Œé«˜ã®èª¿æ•´ */
    .printable-area #weeklyTable thead #dateRow {
      height: 1.5% !important;
    }
    .printable-area #weeklyTable thead #subHeaderRow {
      height: 1.5% !important;
    }
    .printable-area #weeklyTable tbody tr {
      height: 3.5% !important;
    }
    /* å‚™è€ƒè¡Œ */
    .printable-area #weeklyTable tbody tr:last-child {
        height: auto !important;
    }

    .printable-area #weeklyTable th, .printable-area #weeklyTable td {
      border: 1px solid black !important; /* â˜…ä¿®æ­£ï¼šç”»åƒå‡ºåŠ›ã®ç½«ç·š */
      padding: 0.5mm 0.8mm !important;
      vertical-align: top !important;
      overflow: hidden !important;
      text-overflow: ellipsis !important;
      word-wrap: break-word;
    }
    .printable-area #weeklyTable td.time-cell {
      padding: 1mm !important;
    }

    .printable-area #weeklyTable .memo-content {
        margin-top: 0.5mm !important;
        padding-top: 0.5mm !important;
        border-top: 1px solid black !important;
        font-size: 0.7em !important;
    }
    .printable-area .daily-summary {
      margin-top: 1mm !important;
      padding-top: 1mm !important;
      border-top: 1px solid black !important;
      font-size: 0.7em !important;
    }
    .printable-area .daily-summary p {
      font-size: 0.8em !important;
      margin: 0.5mm 0 !important;
      line-height: 1.0 !important;
    }
  </style>
 </head>
 <body>
  <header>
    <h1>é€±é–“è¡¨ç¤º</h1>
    <div class="top-icons">
      <a href="index.html" title="æ´»å‹•è¨˜éŒ²">âœï¸</a>
      <a href="#" id="saveImageBtn" title="ç”»åƒã‚’ä¿å­˜">ğŸ“·</a>
    </div>
  </header>

  <div class="week-navigation">
    <button id="prevWeekBtn">â† å‰ã®é€±</button>
    <span id="weekDisplay"></span>
    <button id="nextWeekBtn">æ¬¡ã®é€± â†’</button>
  </div>

  <div id="weeklyTableContainer">
    <table id="weeklyTable">
      <thead>
        <tr id="dateRow">
          <th rowspan="2">æ™‚é–“</th>
        </tr>
        <tr id="subHeaderRow"></tr>
      </thead>
      <tbody id="weeklyTableBody">
        </tbody>
    </table>
  </div>

  <script>
    const daysOfWeek = ["æ—¥", "æœˆ", "ç«", "æ°´", "æœ¨", "é‡‘", "åœŸ"];
    const weeklyTableBody = document.getElementById('weeklyTableBody');
    const dateRow = document.getElementById('dateRow');
    const subHeaderRow = document.getElementById('subHeaderRow');
    const weekDisplay = document.getElementById('weekDisplay');
    const prevWeekBtn = document.getElementById('prevWeekBtn');
    const nextWeekBtn = document.getElementById('nextWeekBtn');
    const saveImageBtn = document.getElementById('saveImageBtn');

    let currentMonday = getMonday(new Date()); // ç¾åœ¨è¡¨ç¤ºã—ã¦ã„ã‚‹é€±ã®æœˆæ›œæ—¥

    // æŒ‡å®šã•ã‚ŒãŸæ—¥ä»˜ã®é€±ã®æœˆæ›œæ—¥ã‚’å–å¾—ã™ã‚‹é–¢æ•° (UTCåŸºæº–)
    // ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã«ã‚ˆã‚‹ãšã‚Œã‚’é˜²ããŸã‚ã€å¸¸ã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§æ‰±ã†ã‚ˆã†å¤‰æ›´
    function getMonday(date) {
        const d = new Date(date);
        const day = d.getDay(); // ãƒ­ãƒ¼ã‚«ãƒ«ã®æ›œæ—¥ã‚’å–å¾— (0=æ—¥æ›œ, 1=æœˆæ›œ...)
        // ãƒ­ãƒ¼ã‚«ãƒ«ã®æ—¥ä»˜ã‚’æœˆæ›œæ—¥ã«èª¿æ•´
        // æ—¥æ›œ(0)ã®å ´åˆã¯6æ—¥å‰ (å‰ã®é€±ã®æœˆæ›œæ—¥)
        // æœˆæ›œ(1)ã®å ´åˆã¯0æ—¥å‰
        // ç«æ›œ(2)ã®å ´åˆã¯1æ—¥å‰ ...
        const diff = d.getDate() - day + (day === 0 ? -6 : 1);
        d.setDate(diff);
        d.setHours(0, 0, 0, 0); // æ™‚é–“ã‚’ãƒªã‚»ãƒƒãƒˆ (ãƒ­ãƒ¼ã‚«ãƒ«)
        return d;
    }

    // æ—¥ä»˜ã‚’ "MM/DD(æ›œæ—¥)" å½¢å¼ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ (ãƒ­ãƒ¼ã‚«ãƒ«ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§è¡¨ç¤º)
    function formatDate(date) {
      const month = (date.getMonth() + 1).toString().padStart(2, '0');
      const day = date.getDate().toString().padStart(2, '0');
      const dayOfWeek = daysOfWeek
